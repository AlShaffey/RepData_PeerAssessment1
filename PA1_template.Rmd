---
title: "Reproducible Research: Peer Assessment 1"
output: 
html_document:
keep_md: true
---

This is to remove the messages all over the document.
```{r setup}
knitr::opts_chunk$set(message = F)
```


## Loading and preprocessing the data
```{r loading_reprocessing}
library(readr)
activities <- read_csv("activity.zip", col_types = cols())

library(dplyr, quietly = TRUE)
mutated <- mutate(activities, clean_steps = ifelse(is.na(steps), 0, steps))
mutated
```


## What is mean total number of steps taken per day?
```{r statistics_per_day}
grouped_dates <- group_by(mutated, date)
summarized_daily_steps <- summarise(grouped_dates, date, total_steps = max(clean_steps))

library(ggplot2)
qplot(summarized_daily_steps$total_steps, geom="histogram", xlab="Daily total steps") 
daily_total_mean <- mean(summarized_daily_steps$total_steps)
daily_total_median <- median(summarized_daily_steps$total_steps)
```
The mean of the total number of steps taken per day is `r daily_total_mean` and the median is `r daily_total_median`

## What is the average daily activity pattern?



```{r average_interval_steps}
grouped_intervals <- group_by(mutated, interval)
summarized_interval_average <- summarise(grouped_intervals, interval, average_steps = mean(clean_steps))

qplot(interval, average_steps, data = summarized_interval_average, geom="path", ylab="Average steps") 

max_average_steps <- max(summarized_interval_average$average_steps)
filtered <- filter(summarized_interval_average, average_steps == max_average_steps)
max_average_interval <- unique(filtered$interval)
```
The 5-minute interval, on average across all the days in the data set, contains the maximum number of steps is `r max_average_interval`

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
